
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="css/popup.css">
    <script src="js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript">
        var oldValue="";

        function popUpMedication(editBtn){
            document.getElementById('light4').style.display='block';
            document.getElementById('fade4').style.display='block';

            var selectedLabel = editBtn.parentNode.textContent.split("\n")[1].trim();
            oldValue = selectedLabel;

            document.getElementById('txtArea4').textContent = oldValue;
        }

        function updateMedication(){
            var newValue = document.getElementById('txtArea4').value.trim();
            var ssn = <?php echo $ssn; ?>;

            $.ajax({
                type: "POST",
                url: 'medications/updateMedication.php',
                data: { ssn: ssn, oldValue: oldValue, newValue: newValue},
                success: function(data){
                    document.getElementById('bottomLabel4').textContent = data;
                },
                error: function(data){
                    document.getElementById('bottomLabel4').textContent = data;
                }
            });
        }

        function deleteMedication(deleteBtn){
            var selectedLabel = deleteBtn.parentNode.textContent.split("\n")[1].trim();
            if (confirm('Are you sure you want to delete this item?')) {
                var ssn = <?php echo $ssn; ?>;
                $.ajax({
                    type: "POST",
                    url: 'medications/deleteMedication.php',
                    data: { ssn: ssn, value: selectedLabel},
                    success: function(data){
                        alert(data);
                    },
                    error: function(data){
                        alert(data);
                    }
                });
                location.reload();
            } else {
                // Do nothing!
            }
        }

        function addNewMedication(addNewItem){
            document.getElementById('light4').style.display='block';
            document.getElementById('fade4').style.display='block';

            document.getElementById('btnSave4').textContent='Add';
            document.getElementById('btnSave4').onclick = function(){ addMedication(document.getElementById('btnSave4')); };
        }

        function addMedication(addBtn){
            var newValue = document.getElementById('txtArea4').value.trim();
            var ssn = <?php echo $ssn; ?>;

            $.ajax({
                type: "POST",
                url: 'medications/addMedication.php',
                data: { ssn: ssn, newValue: newValue},
                success: function(data){
                    document.getElementById('bottomLabel4').textContent = data;
                },
                error: function(data){
                    document.getElementById('bottomLabel4').textContent = data;
                }
            });
        }

        function closeMedication(){
            document.getElementById('light4').style.display='none';
            document.getElementById('fade4').style.display='none';
            location.reload();
        }

    </script>
</head>
<body>

{{{_sections.medications}}}

</body>

</html>
